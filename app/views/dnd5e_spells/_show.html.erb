
 <h1> <%= spell.name %> </h1>

<p>
<strong><%= spell.spell_type %> <%= spell.level %></strong>
</p>

<p>
	<strong>Class Level:</strong>
	
	<% @archetype_spells = Dnd5eArchetypeSpell.archetypes_that_know_this_spell_by_level(spell.id)%>
	<% @class_spells = Dnd5eClassSpell.classes_that_know_this_spell_by_level(spell.id) %>
	<% @class_spells.each_with_index do |m, index| %>
		<%= m.name %>
		<%= Dnd5eClassSpell.where(dnd5e_class_id: m.id,dnd5e_spell_id: spell.id).take.level %>
		<% if ( ( index + 1 ) % 2 ) == 0 and @class_spells.length != ( index + 1) %>
			<br>		
		<% end %>
		
		<% if index % 2 == 0 and @class_spells.length != 1 or ( @archetype_spells.length == 1 and @class_spells.length == 1 ) %>
			<label>,</label>
		<% end %>
	<% end %>
	<%@archetype_spells.each_with_index do |m, index| %>
		<% if ( (  index + @class_spells.length) % 2 ) == 0 and ( @archetype_spells.length != 1 or @class_spells.length % 2 == 0 ) and ( @archetype_spells.length == 0 and @class_spells.length == 0  ) %>
			<br>		
		<% end %>
		<%= m.name %>
		<%= Dnd5eArchetypeSpell.where(dnd5e_archetype_id: m.id,dnd5e_spell_id: spell.id).take.level %>
		<% if @class_spells.length != 0 and ( index + @class_spells.length + 1 ) % 2 != 0 and ( index + 1 ) != @archetype_spells.length  %>	
			<label>,</label>
		<% end %>
		
	<% end %>
</p>

<p>
<strong>Casting Time:</strong>
  <%= spell.cast %>
</p>

<p>
<strong>Range:</strong>
  <%= spell.range %>
</p>

<p>
<strong>Components:</strong>
  <%= spell.components %>
</p>

<p>
<strong>Duration:</strong>
  <%= spell.duration %>
</p>

<p>
<strong>Concentration:</strong>
  <%= spell.concentration %>
</p>

<p>
<strong>Ritual:</strong>
  <%= spell.ritual %>
</p>

<p>
  <%=  spell.description.html_safe %>
</p>
